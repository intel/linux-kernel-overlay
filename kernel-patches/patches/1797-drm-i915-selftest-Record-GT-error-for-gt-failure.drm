From 3f6b409cd8993845de2a468d938a9e2673a8bb98 Mon Sep 17 00:00:00 2001
From: Tejas Upadhyay <tejas.upadhyay@intel.com>
Date: Mon, 24 Apr 2023 19:06:07 +0530
Subject: [PATCH 1797/2351] drm/i915/selftest: Record GT error for gt failure

igt_live_test has pr_err dumped in case of some
GT failures. It will be more informative regarding
GT if we use gt_err instead.

Cc: Andi Shyti <andi.shyti@intel.com>
Signed-off-by: Tejas Upadhyay <tejas.upadhyay@intel.com>
Reviewed-by: Andi Shyti <andi.shyti@linux.intel.com>
Signed-off-by: Andi Shyti <andi.shyti@linux.intel.com>
Link: https://patchwork.freedesktop.org/patch/msgid/20230424133607.3736825-1-tejas.upadhyay@intel.com
---
 drivers/gpu/drm/i915/selftests/igt_live_test.c | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/drivers/gpu/drm/i915/selftests/igt_live_test.c b/drivers/gpu/drm/i915/selftests/igt_live_test.c
index 714b7afc490b3..4ddc6d902752a 100644
--- a/drivers/gpu/drm/i915/selftests/igt_live_test.c
+++ b/drivers/gpu/drm/i915/selftests/igt_live_test.c
@@ -6,6 +6,7 @@
 
 #include "i915_drv.h"
 #include "gt/intel_gt.h"
+#include "gt/intel_gt_print.h"
 
 #include "../i915_selftest.h"
 #include "igt_flush_test.h"
@@ -30,7 +31,7 @@ int igt_live_test_begin(struct igt_live_test *t,
 
 		err = intel_gt_wait_for_idle(gt, MAX_SCHEDULE_TIMEOUT);
 		if (err) {
-			pr_err("%s(%s): failed to idle before, with err=%d!",
+			gt_err(gt, "%s(%s): GT failed to idle before, with err=%d!",
 			       func, name, err);
 			return err;
 		}
@@ -69,7 +70,7 @@ int igt_live_test_end(struct igt_live_test *t)
 			    i915_reset_engine_count(&i915->gpu_error, engine))
 				continue;
 
-			pr_err("%s(%s): engine '%s' was reset %d times!\n",
+			gt_err(gt, "%s(%s): engine '%s' was reset %d times!\n",
 			       t->func, t->name, engine->name,
 			       i915_reset_engine_count(&i915->gpu_error, engine) -
 			       t->reset_engine[id]);
-- 
2.25.1

