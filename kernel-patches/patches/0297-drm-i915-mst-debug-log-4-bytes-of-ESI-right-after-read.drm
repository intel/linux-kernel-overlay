From 64f705abe27af8ebd289b7413859a5312fc194ca Mon Sep 17 00:00:00 2001
From: Jani Nikula <jani.nikula@intel.com>
Date: Wed, 12 Jan 2022 13:03:15 +0200
Subject: [PATCH 0297/2251] drm/i915/mst: debug log 4 bytes of ESI right after
 reading

For whatever reason, the ESI link service irq vector was missing from
the debug output. Add the missing byte, clean up the debug message, and
do the logging right after reading the data.

Signed-off-by: Jani Nikula <jani.nikula@intel.com>
Reviewed-by: Uma Shankar <uma.shankar@intel.com>
Link: https://patchwork.freedesktop.org/patch/msgid/20220112110319.1172110-3-jani.nikula@intel.com
---
 drivers/gpu/drm/i915/display/intel_dp.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/drivers/gpu/drm/i915/display/intel_dp.c b/drivers/gpu/drm/i915/display/intel_dp.c
index 20aad8befd3c..2b60f61dbd51 100644
--- a/drivers/gpu/drm/i915/display/intel_dp.c
+++ b/drivers/gpu/drm/i915/display/intel_dp.c
@@ -3657,6 +3657,8 @@ intel_dp_check_mst_status(struct intel_dp *intel_dp)
 			break;
 		}
 
+		drm_dbg_kms(&i915->drm, "DPRX ESI: %4ph\n", esi);
+
 		/* check link status - esi[10] = 0x200c */
 		if (intel_dp->active_mst_links > 0 && link_ok &&
 		    !drm_dp_channel_eq_ok(&esi[10], intel_dp->lane_count)) {
@@ -3665,8 +3667,6 @@ intel_dp_check_mst_status(struct intel_dp *intel_dp)
 			link_ok = false;
 		}
 
-		drm_dbg_kms(&i915->drm, "got esi %3ph\n", esi);
-
 		intel_dp_mst_hpd_irq(intel_dp, esi, &handled);
 
 		if (!handled)
-- 
2.25.1

