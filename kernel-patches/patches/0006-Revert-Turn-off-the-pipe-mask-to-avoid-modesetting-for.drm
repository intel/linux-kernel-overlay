From 43bde982763be56dd38e42ddb9c6444b149ecde9 Mon Sep 17 00:00:00 2001
From: Junxiao Chang <junxiao.chang@intel.com>
Date: Fri, 13 May 2022 14:40:39 +0800
Subject: [PATCH 06/29] Revert "Turn off the pipe mask to avoid modesetting for
 vF"

This reverts commit c092e9d08fbae93ccff1a0d72e25f8fb1379cb68.
---
 drivers/gpu/drm/i915/gt/uc/intel_guc_submission.c | 2 --
 drivers/gpu/drm/i915/i915_sriov.c                 | 1 -
 2 files changed, 3 deletions(-)

diff --git a/drivers/gpu/drm/i915/gt/uc/intel_guc_submission.c b/drivers/gpu/drm/i915/gt/uc/intel_guc_submission.c
index c8c96bd8fbda..cd9ee598a43f 100644
--- a/drivers/gpu/drm/i915/gt/uc/intel_guc_submission.c
+++ b/drivers/gpu/drm/i915/gt/uc/intel_guc_submission.c
@@ -3807,8 +3807,6 @@ int intel_guc_submission_setup(struct intel_engine_cs *engine)
 
 void intel_guc_submission_enable(struct intel_guc *guc)
 {
-	struct intel_gt *gt = guc_to_gt(guc);
-
 	guc_init_lrc_mapping(guc);
 
 	if (!IS_SRIOV_VF(gt->i915))
diff --git a/drivers/gpu/drm/i915/i915_sriov.c b/drivers/gpu/drm/i915/i915_sriov.c
index e42923d5c462..f06bd1ef5fa4 100644
--- a/drivers/gpu/drm/i915/i915_sriov.c
+++ b/drivers/gpu/drm/i915/i915_sriov.c
@@ -178,7 +178,6 @@ static void vf_tweak_device_info(struct drm_i915_private *i915)
 	/* Force PCH_NOOP. We have no access to display */
 	i915->pch_type = PCH_NOP;
 	memset(&info->display, 0, sizeof(info->display));
-	info->pipe_mask = 0;
 	info->memory_regions &= ~(REGION_STOLEN_SMEM |
 				  REGION_STOLEN_LMEM);
 }
-- 
2.25.1

