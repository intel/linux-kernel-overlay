From f0e962c4e9e6e4b0439ad051f7cbefe03fe2a059 Mon Sep 17 00:00:00 2001
From: Lucas De Marchi <lucas.demarchi@intel.com>
Date: Wed, 26 Jan 2022 01:39:41 -0800
Subject: [PATCH 17/29] lib/string_helpers: Consolidate string helpers
 implementation

There are a few implementations of string helpers in the tree like yesno()
that just returns "yes" or "no" depending on a boolean argument. Those
are helpful to output strings to the user or log.

In order to consolidate them, prefix all of them str_ prefix to make it
clear what they are about and avoid symbol clashes.
Taking the commoon `val ? "yes" : "no"` implementation,  quite a few
users of open coded yesno() could later be converted to the new
function:

$ git grep '?\s*"yes"\s*' | wc -l
286
$ git grep '?\s*"no"\s*' | wc -l
20

The inlined function should keep the const strings local to each
compilation unit, the same way it's now, thus not changing the current
behavior.

Signed-off-by: Lucas De Marchi <lucas.demarchi@intel.com>
Reviewed-by: Andy Shevchenko <andy.shevchenko@gmail.com>
Acked-by: Jani Nikula <jani.nikula@intel.com>
Acked-by: Daniel Vetter <daniel.vetter@ffwll.ch>
Link: https://patchwork.freedesktop.org/patch/msgid/20220126093951.1470898-2-lucas.demarchi@intel.com
(cherry picked from commit ea4692c75e1c63926e4fb0728f5775ef0d733888)
[ Fix conflict due to several missing commits touching string_helpers.h:
  acdb89b6c87a ("lib/string_helpers: Introduce managed variant of kasprintf_strarray()")
  418e0a3551bb ("lib/string_helpers: Introduce kasprintf_strarray()")
  bfb3ba32061d ("include/linux/string_helpers.h: add linux/string.h for strlen()")
  cc72181a6599 ("seq_file: drop unused *_escape_mem_ascii()")
  259fa5d7d825 ("lib/test-string_helpers: add test cases for new features")
  aec0d0966f20 ("lib/string_helpers: allow to append additional characters to be escaped")
  0362c27fb373 ("lib/string_helpers: introduce ESCAPE_NAP to escape non-ASCII and non-printable")
  a0809783355c ("lib/string_helpers: introduce ESCAPE_NA for escaping non-ASCII")
  994b69703e86 ("lib/string_helpers: switch to use BIT() macro") ]
Signed-off-by: Lucas De Marchi <lucas.demarchi@intel.com>
---
 include/linux/string_helpers.h | 20 ++++++++++++++++++++
 1 file changed, 20 insertions(+)

diff --git a/include/linux/string_helpers.h b/include/linux/string_helpers.h
index 5665ea13f831..167a62d34acd 100644
--- a/include/linux/string_helpers.h
+++ b/include/linux/string_helpers.h
@@ -97,4 +97,24 @@ char *kstrdup_quotable_file(struct file *file, gfp_t gfp);
 
 void kfree_strarray(char **array, size_t n);
 
+static inline const char *str_yes_no(bool v)
+{
+	return v ? "yes" : "no";
+}
+
+static inline const char *str_on_off(bool v)
+{
+	return v ? "on" : "off";
+}
+
+static inline const char *str_enable_disable(bool v)
+{
+	return v ? "enable" : "disable";
+}
+
+static inline const char *str_enabled_disabled(bool v)
+{
+	return v ? "enabled" : "disabled";
+}
+
 #endif
-- 
2.25.1

