From ef0f42f7353e705ae5d123b52e873124c13d0e76 Mon Sep 17 00:00:00 2001
From: Sun Jian <jian.sun@intel.com>
Date: Mon, 12 Jul 2021 16:23:17 +0800
Subject: [PATCH 882/888] force vcpu wakeup after virtual lapic interrupt
 posting

Signed-off-by: Sun Jian <jian.sun@intel.com>
Signed-off-by: Zawawi, Muhammad Zul Husni <muhammad.zul.husni.zawawi@intel.com>
---
 arch/x86/kvm/lapic.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/arch/x86/kvm/lapic.c b/arch/x86/kvm/lapic.c
index 49b058f4f3d8..9e499fe54302 100644
--- a/arch/x86/kvm/lapic.c
+++ b/arch/x86/kvm/lapic.c
@@ -1095,6 +1095,8 @@ static int __apic_accept_irq(struct kvm_lapic *apic, int delivery_mode,
 			kvm_make_request(KVM_REQ_EVENT, vcpu);
 			kvm_vcpu_kick(vcpu);
 		}
+
+		kvm_vcpu_kick(vcpu);
 		break;
 
 	case APIC_DM_REMRD:
-- 
2.25.1

