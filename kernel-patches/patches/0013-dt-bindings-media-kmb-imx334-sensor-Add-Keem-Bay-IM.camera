From cc86efcacf1697e6137c5151c23deecbd5145e05 Mon Sep 17 00:00:00 2001
From: Martina Krasteva <martinax.krasteva@intel.com>
Date: Fri, 26 Jun 2020 17:17:27 +0100
Subject: [PATCH 13/42] dt-bindings: media: kmb-imx334-sensor: Add Keem Bay
 IMX334 sensor

The Keem Bay imx334 sensor is a Sony CMOS active pixel digital image
sensor with an active array size of 3864H x 2202V. It is programmable
through I2C interface. The I2C address is fixed to 0x1a as per sensor
data sheet. Image  data is sent through MIPI CSI-2, which is configured
as 4 lanes at 1188 Mbps.

The sensor can also be probed as platform device and later on registered
to the I2C bus. Probing as platform device is used when different
sensors with the same slave address must be able to be attached to one
slot. They are probed with priority. Example slot with multiple sensors
attached.

Signed-off-by: Martina Krasteva <martinax.krasteva@intel.com>
Signed-off-by: Daniele Alessandrelli <daniele.alessandrelli@intel.com>
---
 .../media/i2c/intel,kmb-imx334-sensor.yaml    | 110 ++++++++++++++++++
 1 file changed, 110 insertions(+)
 create mode 100644 Documentation/devicetree/bindings/media/i2c/intel,kmb-imx334-sensor.yaml

diff --git a/Documentation/devicetree/bindings/media/i2c/intel,kmb-imx334-sensor.yaml b/Documentation/devicetree/bindings/media/i2c/intel,kmb-imx334-sensor.yaml
new file mode 100644
index 000000000000..0320ad31d73c
--- /dev/null
+++ b/Documentation/devicetree/bindings/media/i2c/intel,kmb-imx334-sensor.yaml
@@ -0,0 +1,110 @@
+# SPDX-License-Identifier: (GPL-2.0-only OR BSD-2-Clause)
+# Copyright (C) 2020 Intel Corporation
+%YAML 1.2
+---
+$id: http://devicetree.org/schemas/media/i2c/intel,kmb-imx334-sensor.yaml#
+$schema: http://devicetree.org/meta-schemas/core.yaml#
+
+title: KeemBay IMX334 Sensor
+
+maintainers:
+  - Daniele Alessandrelli <daniele.alessandrelli@intel.com>
+
+description: |-
+  The KeemBay imx334 sensor is a Sony CMOS active pixel digital image sensor
+  with an active array size of 3864H x 2202V. It is programmable through I2C
+  interface. The I2C client address is fixed to 0x1a as per sensor data sheet.
+  Image data is sent through MIPI CSI-2, which is configured as 4 lanes at
+  1188 Mbps.
+
+  The sensor can also be probed as platform device and later on registered to
+  the I2C bus. Probing as platform device is used when different sensors with
+  the same I2C client address must be able to be attached to one slot.
+  They are probed with priority. Example slot with multiple sensors attached
+
+properties:
+  compatible:
+    oneOf:
+      - items:
+        - const: intel,kmb-imx334-sensor
+      - items:
+        - const: intel,kmb-imx334-sensor-p
+  reg:
+    description: I2C address
+    maxItems: 1
+
+  # See ../video-interfaces.txt for more details
+  flash-leds:
+    description: See ../video-interfaces.txt
+  lens-focus:
+    description: See ../video-interfaces.txt
+  port:
+    type: object
+    properties:
+      endpoint:
+        type: object
+        properties:
+          data-lanes:
+              description: See ../video-interfaces.txt
+          clock-lanes:
+              description: See ../video-interfaces.txt
+          link-frequencies:
+            $ref: /schemas/types.yaml#/definitions/uint64-array
+            description: See ../video-interfaces.txt
+          remote-endpoint:
+              description: See ../video-interfaces.txt
+
+        required:
+          - link-frequencies
+
+required:
+  - compatible
+  - port
+
+examples:
+  - |
+    i2c0 {
+          #address-cells = <1>;
+          #size-cells = <0>;
+          label = "LS-I2C1";
+
+          kmb-camera-sensor {
+                reg = <0x1A>;
+                compatible = "intel,kmb-imx334-sensor";
+                port {
+                      kmb_sen_i2c:endpoint {
+                            remote-endpoint = <&cam>;
+                            link-frequencies =
+                                  /bits/ 64 <199200000 210000000 499200000>;
+                            clock-lanes = <0>;
+                            data-lanes = <1 2 3 4>;
+                      };
+                };
+          };
+    };
+  - |
+    #include <dt-bindings/gpio/gpio.h>
+    keembay_cam_a {
+          compatible = "intel,kmb-imx334-sensor-p";
+          i2c-bus = <&i2c1>;
+          lens-focus = <&kmb_lens2>;
+          flash-leds = <&kmb_flash2>;
+          eeprom = <&cama_eeprom>;
+
+          reset-gpios = <&pca0 6 GPIO_ACTIVE_HIGH>;
+
+          detect-gpios = <&pca1 17 GPIO_ACTIVE_HIGH>,
+                <&pca1 6 GPIO_ACTIVE_HIGH>,
+                <&pca1 16 GPIO_ACTIVE_HIGH>;
+          clock-names = "inclk";
+          clocks = <&kmb_clock_buff 0x0>;
+
+          port {
+                cam_a: endpoint {
+                      remote-endpoint = <&cam0>;
+                      link-frequencies = /bits/ 64 <210000000>;
+                      clock-lanes = <0>;
+                      data-lanes = <1 2 3 4>;
+                };
+          };
+    };
-- 
2.17.1

