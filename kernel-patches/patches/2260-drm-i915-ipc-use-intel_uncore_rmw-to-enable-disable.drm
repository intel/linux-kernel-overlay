From decfab48c3a0427975c32d50dd0b0f8620897e28 Mon Sep 17 00:00:00 2001
From: Jani Nikula <jani.nikula@intel.com>
Date: Mon, 12 Sep 2022 14:45:16 +0300
Subject: [PATCH 2260/2779] drm/i915/ipc: use intel_uncore_rmw() to
 enable/disable
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Don't duplicate the rmw function.

Signed-off-by: Jani Nikula <jani.nikula@intel.com>
Reviewed-by: Ville Syrjälä <ville.syrjala@linux.intel.com>
Link: https://patchwork.freedesktop.org/patch/msgid/113a17cd18401b0e4c83396575b67aa6efb07346.1662983005.git.jani.nikula@intel.com
---
 drivers/gpu/drm/i915/display/skl_watermark.c | 12 ++----------
 1 file changed, 2 insertions(+), 10 deletions(-)

diff --git a/drivers/gpu/drm/i915/display/skl_watermark.c b/drivers/gpu/drm/i915/display/skl_watermark.c
index 09249a42a53f..617a1f2d01ea 100644
--- a/drivers/gpu/drm/i915/display/skl_watermark.c
+++ b/drivers/gpu/drm/i915/display/skl_watermark.c
@@ -3127,19 +3127,11 @@ bool skl_watermark_ipc_enabled(struct drm_i915_private *i915)
 
 void skl_watermark_ipc_update(struct drm_i915_private *i915)
 {
-	u32 val;
-
 	if (!HAS_IPC(i915))
 		return;
 
-	val = intel_uncore_read(&i915->uncore, DISP_ARB_CTL2);
-
-	if (skl_watermark_ipc_enabled(i915))
-		val |= DISP_IPC_ENABLE;
-	else
-		val &= ~DISP_IPC_ENABLE;
-
-	intel_uncore_write(&i915->uncore, DISP_ARB_CTL2, val);
+	intel_uncore_rmw(&i915->uncore, DISP_ARB_CTL2, DISP_IPC_ENABLE,
+			 skl_watermark_ipc_enabled(i915) ? DISP_IPC_ENABLE : 0);
 }
 
 static bool skl_watermark_ipc_can_enable(struct drm_i915_private *i915)
-- 
2.25.1

