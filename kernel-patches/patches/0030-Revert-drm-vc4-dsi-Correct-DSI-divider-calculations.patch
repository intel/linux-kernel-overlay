From cc9a4cc689d6c016cddd1a1cda95943c4e19c714 Mon Sep 17 00:00:00 2001
From: Ranjan Dutta <ranjan.dutta@intel.com>
Date: Tue, 6 Sep 2022 07:43:24 +0800
Subject: [PATCH 30/60] Revert "drm/vc4: dsi: Correct DSI divider calculations"

This reverts commit ddf6af3b0b3f75c79aab784e1c7daa9367f9c939.
---
 drivers/gpu/drm/vc4/vc4_dsi.c | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/drivers/gpu/drm/vc4/vc4_dsi.c b/drivers/gpu/drm/vc4/vc4_dsi.c
index 153ad9048db5a..ad84b56f4091d 100644
--- a/drivers/gpu/drm/vc4/vc4_dsi.c
+++ b/drivers/gpu/drm/vc4/vc4_dsi.c
@@ -794,9 +794,11 @@ static bool vc4_dsi_encoder_mode_fixup(struct drm_encoder *encoder,
 	/* Find what divider gets us a faster clock than the requested
 	 * pixel clock.
 	 */
-	for (divider = 1; divider < 255; divider++) {
-		if (parent_rate / (divider + 1) < pll_clock)
+	for (divider = 1; divider < 8; divider++) {
+		if (parent_rate / divider < pll_clock) {
+			divider--;
 			break;
+		}
 	}
 
 	/* Now that we've picked a PLL divider, calculate back to its
-- 
2.25.1

