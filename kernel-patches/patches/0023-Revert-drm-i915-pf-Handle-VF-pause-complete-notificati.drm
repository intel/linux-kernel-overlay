From 01e946c9684ec43939d42a735aa883d70da9c1c9 Mon Sep 17 00:00:00 2001
From: "Zawawi, Muhammad Zul Husni" <muhammad.zul.husni.zawawi@intel.com>
Date: Fri, 17 Nov 2023 13:50:18 +0800
Subject: [PATCH 023/319] Revert "drm/i915/pf: Handle VF pause complete
 notification"

This reverts commit e4220d4f7afecaf2be02f7a93b25098f62b98b12.
---
 drivers/gpu/drm/i915/gt/iov/intel_iov_state.c | 11 +----------
 drivers/gpu/drm/i915/gt/iov/intel_iov_types.h |  2 --
 2 files changed, 1 insertion(+), 12 deletions(-)

diff --git a/drivers/gpu/drm/i915/gt/iov/intel_iov_state.c b/drivers/gpu/drm/i915/gt/iov/intel_iov_state.c
index addcb3c5b417..db018a920b8c 100644
--- a/drivers/gpu/drm/i915/gt/iov/intel_iov_state.c
+++ b/drivers/gpu/drm/i915/gt/iov/intel_iov_state.c
@@ -65,7 +65,6 @@ void intel_iov_state_release(struct intel_iov *iov)
 static void pf_reset_vf_state(struct intel_iov *iov, u32 vfid)
 {
 	iov->pf.state.data[vfid].state = 0;
-	iov->pf.state.data[vfid].paused = false;
 }
 
 /**
@@ -354,7 +353,6 @@ static void pf_handle_vf_flr(struct intel_iov *iov, u32 vfid)
 		return;
 	}
 
-	iov->pf.state.data[vfid].paused = false;
 	dev_info(dev, "VF%u FLR\n", vfid);
 
 	for_each_gt(gt, iov_to_i915(iov), gtid)
@@ -373,7 +371,6 @@ static void pf_handle_vf_pause_done(struct intel_iov *iov, u32 vfid)
 {
 	struct device *dev = iov_to_dev(iov);
 
-	iov->pf.state.data[vfid].paused = true;
 	dev_info(dev, "VF%u %s\n", vfid, "paused");
 }
 
@@ -507,13 +504,7 @@ int intel_iov_state_pause_vf(struct intel_iov *iov, u32 vfid)
  */
 int intel_iov_state_resume_vf(struct intel_iov *iov, u32 vfid)
 {
-	int err = pf_control_vf(iov, vfid, GUC_PF_TRIGGER_VF_RESUME);
-
-	if (err < 0)
-		return err;
-
-	iov->pf.state.data[vfid].paused = false;
-	return 0;
+	return pf_control_vf(iov, vfid, GUC_PF_TRIGGER_VF_RESUME);
 }
 
 /**
diff --git a/drivers/gpu/drm/i915/gt/iov/intel_iov_types.h b/drivers/gpu/drm/i915/gt/iov/intel_iov_types.h
index e570a39da55c..ee2884250df2 100644
--- a/drivers/gpu/drm/i915/gt/iov/intel_iov_types.h
+++ b/drivers/gpu/drm/i915/gt/iov/intel_iov_types.h
@@ -123,7 +123,6 @@ struct intel_iov_provisioning {
 /**
  * struct intel_iov_data - Data related to one VF.
  * @state: VF state bits
- * @paused: FIXME missing doc
  * @adverse_events: FIXME missing doc
  */
 struct intel_iov_data {
@@ -134,7 +133,6 @@ struct intel_iov_data {
 #define IOV_VF_NEEDS_FLR_FINISH		3
 #define IOV_VF_NEEDS_FLR_DONE_SYNC	4
 #define IOV_VF_FLR_FAILED		(BITS_PER_LONG - 1)
-	bool paused;
 	unsigned int adverse_events[IOV_THRESHOLD_MAX];
 };
 
-- 
2.25.1

