From fc3ca07de9c09bfe8b6d7354d15f85e4f0277414 Mon Sep 17 00:00:00 2001
From: Ranjan Dutta <ranjan.dutta@intel.com>
Date: Mon, 20 Dec 2021 20:49:10 +0800
Subject: [PATCH 04/16] Revert "drm/syncobj: Deal with signalled fences in
 drm_syncobj_find_fence."

This reverts commit 2737d0bc21b6db199b4145e12b9f1745577d7944.
---
 drivers/gpu/drm/drm_syncobj.c | 11 +----------
 1 file changed, 1 insertion(+), 10 deletions(-)

diff --git a/drivers/gpu/drm/drm_syncobj.c b/drivers/gpu/drm/drm_syncobj.c
index 993898a2c779..349146049849 100644
--- a/drivers/gpu/drm/drm_syncobj.c
+++ b/drivers/gpu/drm/drm_syncobj.c
@@ -391,17 +391,8 @@ int drm_syncobj_find_fence(struct drm_file *file_private,
 
 	if (*fence) {
 		ret = dma_fence_chain_find_seqno(fence, point);
-		if (!ret) {
-			/* If the requested seqno is already signaled
-			 * drm_syncobj_find_fence may return a NULL
-			 * fence. To make sure the recipient gets
-			 * signalled, use a new fence instead.
-			 */
-			if (!*fence)
-				*fence = dma_fence_get_stub();
-
+		if (!ret)
 			goto out;
-		}
 		dma_fence_put(*fence);
 	} else {
 		ret = -EINVAL;
-- 
2.27.0

