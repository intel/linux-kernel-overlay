From 64161189cfb2c613fd95ddc14e7a433158c84de7 Mon Sep 17 00:00:00 2001
From: "Chew, Tong Liang" <tong.liang.chew@intel.com>
Date: Wed, 17 Jan 2024 17:23:36 +0800
Subject: [PATCH 47/52] drm/i915/iov: resolved the error code where
 pf_resume_active_vfs was added in wrong place
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Signed-off-by: Chew, Tong Liang <tong.liang.chew@intel.com>
Signed-off-by: Piotr Pi√≥rkowski <piotr.piorkowski@intel.com>
---
 drivers/gpu/drm/i915/i915_sriov.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/drivers/gpu/drm/i915/i915_sriov.c b/drivers/gpu/drm/i915/i915_sriov.c
index 82c102227840..78d4faa282f0 100644
--- a/drivers/gpu/drm/i915/i915_sriov.c
+++ b/drivers/gpu/drm/i915/i915_sriov.c
@@ -1312,7 +1312,6 @@ int i915_sriov_suspend_prepare(struct drm_i915_private *i915)
 	intel_wakeref_t wakeref;
 
 	if (IS_SRIOV_PF(i915)) {
-		pf_resume_active_vfs(i915);
 		/*
 		 * When we're enabling the VFs in i915_sriov_pf_enable_vfs(), we also get
 		 * a GT PM wakeref which we hold for the whole VFs life cycle.
@@ -1347,6 +1346,7 @@ int i915_sriov_resume(struct drm_i915_private *i915)
 	intel_wakeref_t wakeref;
 
 	if (IS_SRIOV_PF(i915)) {
+		pf_resume_active_vfs(i915);
 		/*
 		 * When we're enabling the VFs in i915_sriov_pf_enable_vfs(), we also get
 		 * a GT PM wakeref which we hold for the whole VFs life cycle.
-- 
2.25.1

