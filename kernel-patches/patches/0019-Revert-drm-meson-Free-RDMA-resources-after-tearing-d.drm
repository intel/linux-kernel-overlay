From 470d112704777348a79109d00b9020a935c0b79e Mon Sep 17 00:00:00 2001
From: Ranjan Dutta <ranjan.dutta@intel.com>
Date: Thu, 7 Jan 2021 11:20:59 +0800
Subject: [PATCH 19/42] Revert "drm/meson: Free RDMA resources after tearing
 down DRM"

This reverts commit d2ddf64f5e9630dbec32b16d6480043006282388.
---
 drivers/gpu/drm/meson/meson_drv.c | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)

diff --git a/drivers/gpu/drm/meson/meson_drv.c b/drivers/gpu/drm/meson/meson_drv.c
index 324fa489f1c4..8b9c8dd788c4 100644
--- a/drivers/gpu/drm/meson/meson_drv.c
+++ b/drivers/gpu/drm/meson/meson_drv.c
@@ -389,15 +389,15 @@ static void meson_drv_unbind(struct device *dev)
 		meson_canvas_free(priv->canvas, priv->canvas_id_vd1_2);
 	}
 
-	drm_dev_unregister(drm);
-	drm_irq_uninstall(drm);
-	drm_kms_helper_poll_fini(drm);
-	drm_dev_put(drm);
-
 	if (priv->afbcd.ops) {
 		priv->afbcd.ops->reset(priv);
 		meson_rdma_free(priv);
 	}
+
+	drm_dev_unregister(drm);
+	drm_irq_uninstall(drm);
+	drm_kms_helper_poll_fini(drm);
+	drm_dev_put(drm);
 }
 
 static const struct component_master_ops meson_drv_master_ops = {
-- 
2.25.1

