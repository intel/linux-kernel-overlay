From b0d17d55032aef59038bbed504ac37af681294f3 Mon Sep 17 00:00:00 2001
From: Alexander Usyskin <alexander.usyskin@intel.com>
Date: Wed, 28 Sep 2022 20:40:37 +0300
Subject: [PATCH 06/18] INTEL_DII: mei: gsc: add fields to support force wake
 to mei auxiliary device

Add force wake support to mei auxiliary device.
Add flag indicating whatever force wake is needed,
internal device pointer and forcewake_get/put function pointers
to the mei auxiliary device structure.

Signed-off-by: Alexander Usyskin <alexander.usyskin@intel.com>
Reviewed-by: Tomas Winkler <tomas.winkler@intel.com>
---
 include/linux/mei_aux.h | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)

diff --git a/include/linux/mei_aux.h b/include/linux/mei_aux.h
index 506912ad363b..56d3a0726040 100644
--- a/include/linux/mei_aux.h
+++ b/include/linux/mei_aux.h
@@ -9,13 +9,17 @@
 
 /**
  * struct mei_aux_device - mei auxiliary device
- * @aux_dev: - auxiliary device object
+ * @aux_dev: auxiliary device object
  * @irq: interrupt driving the mei auxiliary device
  * @bar: mmio resource bar reserved to mei auxiliary device
  * @ext_op_mem: resource for extend operational memory
  *              used in graphics PXP mode.
  * @slow_firmware: The device has slow underlying firmware.
  *                 Such firmware will require to use larger operation timeouts.
+ * @forcewake_needed: forcewake should be asserted before operations
+ * @gsc: the internal device pointer
+ * @forcewake_get: pointer to the forcewake get function
+ * @forcewake_put: pointer to the forcewake put function
  */
 struct mei_aux_device {
 	struct auxiliary_device aux_dev;
@@ -23,6 +27,10 @@ struct mei_aux_device {
 	struct resource bar;
 	struct resource ext_op_mem;
 	bool slow_firmware;
+	bool forcewake_needed;
+	void *gsc;
+	void (*forcewake_get)(void *gsc);
+	void (*forcewake_put)(void *gsc);
 };
 
 #define auxiliary_dev_to_mei_aux_dev(auxiliary_dev) \
-- 
2.25.1

