From 4eface2fc1ff3a500024adfb468369d62697306f Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Christian=20K=C3=B6nig?= <christian.koenig@amd.com>
Date: Fri, 18 Sep 2020 16:20:20 +0200
Subject: [PATCH 0006/1714] drm/ttm: remove nonsense AGP handling
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

map_page_into_agp() and unmap_page_from_agp() are only defined on x86.

On all other platforms they are defined as noops. So this code doesn't has any effect at all.

Signed-off-by: Christian KÃ¶nig <christian.koenig@amd.com>
Reviewed-by: Alex Deucher <alexander.deucher@amd.com>
Link: https://patchwork.freedesktop.org/patch/391292/
---
 include/drm/ttm/ttm_set_memory.h | 44 --------------------------------
 1 file changed, 44 deletions(-)

diff --git a/include/drm/ttm/ttm_set_memory.h b/include/drm/ttm/ttm_set_memory.h
index 7c492b49e38c..3966655b72f1 100644
--- a/include/drm/ttm/ttm_set_memory.h
+++ b/include/drm/ttm/ttm_set_memory.h
@@ -71,48 +71,6 @@ static inline int ttm_set_pages_uc(struct page *page, int numpages)
 
 #else /* for CONFIG_X86 */
 
-#if IS_ENABLED(CONFIG_AGP)
-
-#include <asm/agp.h>
-
-static inline int ttm_set_pages_array_wb(struct page **pages, int addrinarray)
-{
-	int i;
-
-	for (i = 0; i < addrinarray; i++)
-		unmap_page_from_agp(pages[i]);
-	return 0;
-}
-
-static inline int ttm_set_pages_array_wc(struct page **pages, int addrinarray)
-{
-	int i;
-
-	for (i = 0; i < addrinarray; i++)
-		map_page_into_agp(pages[i]);
-	return 0;
-}
-
-static inline int ttm_set_pages_array_uc(struct page **pages, int addrinarray)
-{
-	int i;
-
-	for (i = 0; i < addrinarray; i++)
-		map_page_into_agp(pages[i]);
-	return 0;
-}
-
-static inline int ttm_set_pages_wb(struct page *page, int numpages)
-{
-	int i;
-
-	for (i = 0; i < numpages; i++)
-		unmap_page_from_agp(page++);
-	return 0;
-}
-
-#else /* for CONFIG_AGP */
-
 static inline int ttm_set_pages_array_wb(struct page **pages, int addrinarray)
 {
 	return 0;
@@ -133,8 +91,6 @@ static inline int ttm_set_pages_wb(struct page *page, int numpages)
 	return 0;
 }
 
-#endif /* for CONFIG_AGP */
-
 static inline int ttm_set_pages_wc(struct page *page, int numpages)
 {
 	return 0;
-- 
2.25.1

