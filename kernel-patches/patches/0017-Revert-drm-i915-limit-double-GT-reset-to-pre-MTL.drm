From 102d82d8b5ca5944089ff1463f38f000fb75c076 Mon Sep 17 00:00:00 2001
From: Junxiao Chang <junxiao.chang@intel.com>
Date: Thu, 6 Jul 2023 15:01:15 +0800
Subject: [PATCH 0017/2351] Revert "drm/i915: limit double GT reset to pre-MTL"

This reverts commit c88b9d6554da17d0cd19fa1baa4e98dc3ee193c9.
---
 drivers/gpu/drm/i915/gt/intel_reset.c | 9 +--------
 1 file changed, 1 insertion(+), 8 deletions(-)

diff --git a/drivers/gpu/drm/i915/gt/intel_reset.c b/drivers/gpu/drm/i915/gt/intel_reset.c
index 71ed2da8c8887..30e9d48011c4e 100644
--- a/drivers/gpu/drm/i915/gt/intel_reset.c
+++ b/drivers/gpu/drm/i915/gt/intel_reset.c
@@ -270,7 +270,7 @@ static int ilk_do_reset(struct intel_gt *gt, intel_engine_mask_t engine_mask,
 static int gen6_hw_domain_reset(struct intel_gt *gt, u32 hw_domain_mask)
 {
 	struct intel_uncore *uncore = gt->uncore;
-	int loops = GRAPHICS_VER_FULL(gt->i915) < IP_VER(12, 70) ? 2 : 1; /* see comment below */
+	int loops = 2;
 	int err;
 
 	/*
@@ -294,13 +294,6 @@ static int gen6_hw_domain_reset(struct intel_gt *gt, u32 hw_domain_mask)
 		 * value. However, there is still a concern that upon
 		 * leaving the second reset, the internal engine state
 		 * is still in flux and not ready for resuming.
-		 *
-		 * Starting on MTL, there are some prep steps that we need to do
-		 * when resetting some engines that need to be applied every
-		 * time we write to GEN6_GDRST. As those are time consuming
-		 * (tens of ms), we don't want to perform that twice, so, since
-		 * the Jasperlake issue hasn't been observed on MTL, we avoid
-		 * repeating the reset.
 		 */
 		err = __intel_wait_for_register_fw(uncore, GEN6_GDRST,
 						   hw_domain_mask, 0,
-- 
2.25.1

