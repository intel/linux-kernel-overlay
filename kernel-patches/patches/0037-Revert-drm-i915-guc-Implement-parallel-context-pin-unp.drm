From 372b98ee31ff4a407512188d404e3cef3d31811f Mon Sep 17 00:00:00 2001
From: Junxiao Chang <junxiao.chang@intel.com>
Date: Wed, 24 Nov 2021 13:16:39 +0800
Subject: [PATCH 037/888] Revert "drm/i915/guc: Implement parallel context pin
 / unpin functions"

This reverts commit 8ba708902516bf34c24758b591c1a37d286af05a.
---
 .../gpu/drm/i915/gt/uc/intel_guc_submission.c | 70 -------------------
 1 file changed, 70 deletions(-)

diff --git a/drivers/gpu/drm/i915/gt/uc/intel_guc_submission.c b/drivers/gpu/drm/i915/gt/uc/intel_guc_submission.c
index 1fa6542f8514..bafbd58c8659 100644
--- a/drivers/gpu/drm/i915/gt/uc/intel_guc_submission.c
+++ b/drivers/gpu/drm/i915/gt/uc/intel_guc_submission.c
@@ -2398,76 +2398,6 @@ static const struct intel_context_ops virtual_guc_context_ops = {
 	.get_sibling = guc_virtual_get_sibling,
 };
 
-/* Future patches will use this function */
-__maybe_unused
-static int guc_parent_context_pin(struct intel_context *ce, void *vaddr)
-{
-	struct intel_engine_cs *engine = guc_virtual_get_sibling(ce->engine, 0);
-	struct intel_guc *guc = ce_to_guc(ce);
-	int ret;
-
-	GEM_BUG_ON(!intel_context_is_parent(ce));
-	GEM_BUG_ON(!intel_engine_is_virtual(ce->engine));
-
-	ret = pin_guc_id(guc, ce);
-	if (unlikely(ret < 0))
-		return ret;
-
-	return __guc_context_pin(ce, engine, vaddr);
-}
-
-/* Future patches will use this function */
-__maybe_unused
-static int guc_child_context_pin(struct intel_context *ce, void *vaddr)
-{
-	struct intel_engine_cs *engine = guc_virtual_get_sibling(ce->engine, 0);
-
-	GEM_BUG_ON(!intel_context_is_child(ce));
-	GEM_BUG_ON(!intel_engine_is_virtual(ce->engine));
-
-	__intel_context_pin(ce->parent);
-	return __guc_context_pin(ce, engine, vaddr);
-}
-
-/* Future patches will use this function */
-__maybe_unused
-static void guc_parent_context_unpin(struct intel_context *ce)
-{
-	struct intel_guc *guc = ce_to_guc(ce);
-
-	GEM_BUG_ON(context_enabled(ce));
-	GEM_BUG_ON(intel_context_is_barrier(ce));
-	GEM_BUG_ON(!intel_context_is_parent(ce));
-	GEM_BUG_ON(!intel_engine_is_virtual(ce->engine));
-
-	unpin_guc_id(guc, ce);
-	lrc_unpin(ce);
-}
-
-/* Future patches will use this function */
-__maybe_unused
-static void guc_child_context_unpin(struct intel_context *ce)
-{
-	GEM_BUG_ON(context_enabled(ce));
-	GEM_BUG_ON(intel_context_is_barrier(ce));
-	GEM_BUG_ON(!intel_context_is_child(ce));
-	GEM_BUG_ON(!intel_engine_is_virtual(ce->engine));
-
-	lrc_unpin(ce);
-}
-
-/* Future patches will use this function */
-__maybe_unused
-static void guc_child_context_post_unpin(struct intel_context *ce)
-{
-	GEM_BUG_ON(!intel_context_is_child(ce));
-	GEM_BUG_ON(!intel_context_is_pinned(ce->parent));
-	GEM_BUG_ON(!intel_engine_is_virtual(ce->engine));
-
-	lrc_post_unpin(ce);
-	intel_context_unpin(ce->parent);
-}
-
 static bool
 guc_irq_enable_breadcrumbs(struct intel_breadcrumbs *b)
 {
-- 
2.25.1

