From 4051c541a9a5975c9c5987cea52a2d335692aaa5 Mon Sep 17 00:00:00 2001
From: Ranjan Dutta <ranjan.dutta@intel.com>
Date: Wed, 16 Feb 2022 00:20:20 +0800
Subject: [PATCH 40/50] Revert "drm/rockchip: dsi: Reconfigure hardware on
 resume()"

This reverts commit 9ddfa1c19191671a8aafcc5cf9181c3d0351be43.
---
 .../gpu/drm/rockchip/dw-mipi-dsi-rockchip.c   | 37 -------------------
 1 file changed, 37 deletions(-)

diff --git a/drivers/gpu/drm/rockchip/dw-mipi-dsi-rockchip.c b/drivers/gpu/drm/rockchip/dw-mipi-dsi-rockchip.c
index b0fb3c3cba59..6691e4523012 100644
--- a/drivers/gpu/drm/rockchip/dw-mipi-dsi-rockchip.c
+++ b/drivers/gpu/drm/rockchip/dw-mipi-dsi-rockchip.c
@@ -243,8 +243,6 @@ struct dw_mipi_dsi_rockchip {
 	struct dw_mipi_dsi *dmd;
 	const struct rockchip_dw_dsi_chip_data *cdata;
 	struct dw_mipi_dsi_plat_data pdata;
-
-	bool dsi_bound;
 };
 
 struct dphy_pll_parameter_map {
@@ -946,8 +944,6 @@ static int dw_mipi_dsi_rockchip_bind(struct device *dev,
 		goto out_pll_clk;
 	}
 
-	dsi->dsi_bound = true;
-
 	return 0;
 
 out_pll_clk:
@@ -969,8 +965,6 @@ static void dw_mipi_dsi_rockchip_unbind(struct device *dev,
 	if (dsi->is_slave)
 		return;
 
-	dsi->dsi_bound = false;
-
 	dw_mipi_dsi_unbind(dsi->dmd);
 
 	clk_disable_unprepare(dsi->pllref_clk);
@@ -1035,36 +1029,6 @@ static const struct dw_mipi_dsi_host_ops dw_mipi_dsi_rockchip_host_ops = {
 	.detach = dw_mipi_dsi_rockchip_host_detach,
 };
 
-static int __maybe_unused dw_mipi_dsi_rockchip_resume(struct device *dev)
-{
-	struct dw_mipi_dsi_rockchip *dsi = dev_get_drvdata(dev);
-	int ret;
-
-	/*
-	 * Re-configure DSI state, if we were previously initialized. We need
-	 * to do this before rockchip_drm_drv tries to re-enable() any panels.
-	 */
-	if (dsi->dsi_bound) {
-		ret = clk_prepare_enable(dsi->grf_clk);
-		if (ret) {
-			DRM_DEV_ERROR(dsi->dev, "Failed to enable grf_clk: %d\n", ret);
-			return ret;
-		}
-
-		dw_mipi_dsi_rockchip_config(dsi);
-		if (dsi->slave)
-			dw_mipi_dsi_rockchip_config(dsi->slave);
-
-		clk_disable_unprepare(dsi->grf_clk);
-	}
-
-	return 0;
-}
-
-static const struct dev_pm_ops dw_mipi_dsi_rockchip_pm_ops = {
-	SET_LATE_SYSTEM_SLEEP_PM_OPS(NULL, dw_mipi_dsi_rockchip_resume)
-};
-
 static int dw_mipi_dsi_rockchip_probe(struct platform_device *pdev)
 {
 	struct device *dev = &pdev->dev;
@@ -1284,7 +1248,6 @@ struct platform_driver dw_mipi_dsi_rockchip_driver = {
 	.remove		= dw_mipi_dsi_rockchip_remove,
 	.driver		= {
 		.of_match_table = dw_mipi_dsi_rockchip_dt_ids,
-		.pm	= &dw_mipi_dsi_rockchip_pm_ops,
 		.name	= "dw-mipi-dsi-rockchip",
 	},
 };
-- 
2.27.0

