From 38199b93679a285466bd148386441fdef88fe6ba Mon Sep 17 00:00:00 2001
From: Daniele Alessandrelli <daniele.alessandrelli@intel.com>
Date: Thu, 9 Jul 2020 16:27:09 +0100
Subject: [PATCH 124/223] keembay-ipc-test: Update to latest IPC changes

Update to latest IPC changes

Signed-off-by: Daniele Alessandrelli <daniele.alessandrelli@intel.com>
---
 drivers/misc/keembay-ipc/keembay-ipc-test.c | 9 +++++----
 1 file changed, 5 insertions(+), 4 deletions(-)

diff --git a/drivers/misc/keembay-ipc/keembay-ipc-test.c b/drivers/misc/keembay-ipc/keembay-ipc-test.c
index 3db1c25a631b..5bedd79a711d 100644
--- a/drivers/misc/keembay-ipc/keembay-ipc-test.c
+++ b/drivers/misc/keembay-ipc/keembay-ipc-test.c
@@ -11,7 +11,6 @@
 #include <linux/init.h>
 #include <linux/io.h>
 #include <linux/jiffies.h>
-#include <linux/keembay-ipc.h>
 #include <linux/kernel.h>
 #include <linux/kthread.h>
 #include <linux/module.h>
@@ -22,6 +21,8 @@
 #include <linux/slab.h>
 #include <linux/string.h>
 
+#include <linux/soc/intel/keembay-ipc.h>
+
 MODULE_LICENSE("GPL v2");
 MODULE_AUTHOR("Daniele Alessandrelli");
 MODULE_DESCRIPTION("A simple Linux module for testing Keem Bay IPC.");
@@ -175,8 +176,8 @@ static int test_loop_thread_fn(void *data)
 	u16 chan_id = params->chan_id;
 	struct device *ipc_dev = params->ipc_dev;
 	int rc, retry;
-	u32 paddr1, paddr2;
-	size_t size1, size2;
+	u32 paddr1;
+	size_t size1;
 	char name[TASK_COMM_LEN];
 
 	get_task_comm(name, current);
@@ -660,7 +661,7 @@ static int init_dut_list(struct list_head *list)
 	struct device *dev = NULL;
 	struct dut *dut;
 
-	ipc_drv = driver_find("kmb-ipc-driver", &platform_bus_type);
+	ipc_drv = driver_find("keembay-ipc", &platform_bus_type);
 	if (!ipc_drv) {
 		pr_err("Cannot find IPC driver\n");
 		return -ENODEV;
-- 
2.27.0

