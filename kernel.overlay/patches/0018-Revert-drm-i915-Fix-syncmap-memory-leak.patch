From c1aa499f92ce7832cf931658eaec9234308217a8 Mon Sep 17 00:00:00 2001
From: Ranjan Dutta <ranjan.dutta@intel.com>
Date: Tue, 21 Sep 2021 12:30:25 +0800
Subject: [PATCH 18/30] Revert "drm/i915: Fix syncmap memory leak"

This reverts commit 257ea8a5edc04d5199db83137fbaa24e1de98e9e.
---
 drivers/gpu/drm/i915/gt/intel_timeline.c | 8 --------
 1 file changed, 8 deletions(-)

diff --git a/drivers/gpu/drm/i915/gt/intel_timeline.c b/drivers/gpu/drm/i915/gt/intel_timeline.c
index e25385ad2c1e..8015964043eb 100644
--- a/drivers/gpu/drm/i915/gt/intel_timeline.c
+++ b/drivers/gpu/drm/i915/gt/intel_timeline.c
@@ -296,14 +296,6 @@ static void intel_timeline_fini(struct intel_timeline *timeline)
 		i915_gem_object_unpin_map(timeline->hwsp_ggtt->obj);
 
 	i915_vma_put(timeline->hwsp_ggtt);
-
-	/*
-	 * A small race exists between intel_gt_retire_requests_timeout and
-	 * intel_timeline_exit which could result in the syncmap not getting
-	 * free'd. Rather than work to hard to seal this race, simply cleanup
-	 * the syncmap on fini.
-	 */
-	i915_syncmap_free(&timeline->sync);
 }
 
 struct intel_timeline *
-- 
2.27.0

