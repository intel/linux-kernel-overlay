From f2a744b12cf68198d201c834a99d3b76b9178a3d Mon Sep 17 00:00:00 2001
From: Ranjan Dutta <ranjan.dutta@intel.com>
Date: Mon, 7 Jun 2021 19:08:42 +0800
Subject: [PATCH 51/78] Revert "drm/amdkfd: Fix cat debugfs hang_hws file
 causes system crash bug"

This reverts commit a98a9004885399631d158cd1cb0ce4d4323cc988.
---
 drivers/gpu/drm/amd/amdkfd/kfd_debugfs.c | 7 +------
 1 file changed, 1 insertion(+), 6 deletions(-)

diff --git a/drivers/gpu/drm/amd/amdkfd/kfd_debugfs.c b/drivers/gpu/drm/amd/amdkfd/kfd_debugfs.c
index 673d5e34f213..511712c2e382 100644
--- a/drivers/gpu/drm/amd/amdkfd/kfd_debugfs.c
+++ b/drivers/gpu/drm/amd/amdkfd/kfd_debugfs.c
@@ -33,11 +33,6 @@ static int kfd_debugfs_open(struct inode *inode, struct file *file)
 
 	return single_open(file, show, NULL);
 }
-static int kfd_debugfs_hang_hws_read(struct seq_file *m, void *data)
-{
-	seq_printf(m, "echo gpu_id > hang_hws\n");
-	return 0;
-}
 
 static ssize_t kfd_debugfs_hang_hws_write(struct file *file,
 	const char __user *user_buf, size_t size, loff_t *ppos)
@@ -99,7 +94,7 @@ void kfd_debugfs_init(void)
 	debugfs_create_file("rls", S_IFREG | 0444, debugfs_root,
 			    kfd_debugfs_rls_by_device, &kfd_debugfs_fops);
 	debugfs_create_file("hang_hws", S_IFREG | 0200, debugfs_root,
-			    kfd_debugfs_hang_hws_read, &kfd_debugfs_hang_hws_fops);
+			    NULL, &kfd_debugfs_hang_hws_fops);
 }
 
 void kfd_debugfs_fini(void)
-- 
2.25.1

