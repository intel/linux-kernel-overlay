From 0c0868e21e196398ea6bfbd3bcc2f47ad732c8f0 Mon Sep 17 00:00:00 2001
From: "David E. Box" <david.e.box@linux.intel.com>
Date: Sun, 21 Mar 2021 17:23:00 -0700
Subject: [PATCH 16/16] platform/s86: intel_sdsi: Add dev_dbg

Signed-off-by: David E. Box <david.e.box@linux.intel.com>
---
 drivers/platform/x86/intel_sdsi.c | 8 ++++++++
 1 file changed, 8 insertions(+)

diff --git a/drivers/platform/x86/intel_sdsi.c b/drivers/platform/x86/intel_sdsi.c
index 49823cf63f51..e1f35f93c330 100644
--- a/drivers/platform/x86/intel_sdsi.c
+++ b/drivers/platform/x86/intel_sdsi.c
@@ -211,10 +211,12 @@ static int intel_sdsi_sysfs_register(struct platform_device *pdev)
 		goto fail_dev_create;
 	}
 	priv->dev = dev;
+	dev_err(&pdev->dev, "dev is %px\n", priv->dev);
 
 	res.start = pci_resource_start(pci_dev, tbir) + offset;
 	res.end = res.start + table->size - 1;
 	res.flags = IORESOURCE_MEM;
+	dev_dbg(&pdev->dev, "%s: Mapping resource %pr\n", __func__, &res);
 
 	priv->sdsi_addr = devm_ioremap_resource(&pdev->dev, &res);
 	if (IS_ERR(priv->sdsi_addr)) {
@@ -292,6 +294,9 @@ static int intel_sdsi_header_decode(struct platform_device *pdev,
 		return -EINVAL;
 	}
 
+	dev_dbg(&pdev->dev, "\naccess_type: %d\nsize: %d\nguid: %d\ntbir: %d\noffset: 0x%x\n",
+		priv->disc_table.access_type, priv->disc_table.size, priv->disc_table.guid,
+		priv->disc_table.tbir, SDSI_GET_OFFSET(priv->disc_table.offset));
 	return 0;
 }
 
@@ -301,6 +306,7 @@ static int intel_sdsi_probe(struct platform_device *pdev)
 	void __iomem *disc_addr;
 	int ret;
 
+	dev_dbg(&pdev->dev, "%s\n", __func__);
 	priv = devm_kzalloc(&pdev->dev, sizeof(*priv), GFP_KERNEL);
 	if (!priv)
 		return -ENOMEM;
@@ -312,6 +318,7 @@ static int intel_sdsi_probe(struct platform_device *pdev)
 	if (IS_ERR(disc_addr))
 		return PTR_ERR(disc_addr);
 
+	dev_dbg(&pdev->dev, "%s: Get discovery table\n", __func__);
 	ret = intel_sdsi_header_decode(pdev, disc_addr);
 	if (ret)
 		return ret;
@@ -320,6 +327,7 @@ static int intel_sdsi_probe(struct platform_device *pdev)
 	if (ret)
 		return ret;
 
+	dev_dbg(&pdev->dev, "%s: probe success\n", __func__);
 	return 0;
 }
 
-- 
2.27.0

